<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>King Saud University - Welcome</title>
    <meta name="description" content="Welcome to King Saud University official website">
    <link rel="stylesheet" href="css/main.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
</head>
<body>
       <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <img src="assets/img/ksu-logo.png" alt="KSU Logo" width="40" height="40" class="me-2">
                <span class="fw-bold">King Saud University</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="calculator.html">
                            <i class="fas fa-calculator me-1"></i>Calculator
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="js.html">
                            <i class="fas fa-code me-1"></i>JS Demo
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">
                            <i class="fas fa-info-circle me-1"></i>About
                        </a>
                    </li>
                      <li class="nav-item">
                       <a id="loginLink" class="nav-link active" href="login.html">
                            <i class="fas fa-user me-1"></i>login
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
     <main class="main-content">
        <section class="profile-section">
            <div class="text-center">
                <img src="" class="rounded" id="Img" >
            </div>
            <p class="profile-info" id="FirstName">login to see</p>
            <p id="LastName">login to see</p>
            <p id="Email">login to see</p>
            <div style="text-align: center; margin-top: 50px;">
  <button id="logoutBtn" class="btn btn-danger">
    <i class="fas fa-sign-out-alt me-1"></i> Logout
  </button>
</div>
        </section>
        
     </main>
     <footer class="footer">
        <div class="footer-links">
            <a href="https://edugate.ksu.edu.sa/ksu/init" class="external-link">Visit KSU Portal</a>
            <a href="about.html" class="internal-link">About</a>
        </div>
    </footer>
<script>

function getCookie(name) {
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  name = name + "=";
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i].trim();
    if (c.indexOf(name) === 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
 
function deleteCookie(name) {
  document.cookie = name + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
}
     
window.addEventListener('DOMContentLoaded', () => {
  const userDataCookie = getCookie('loggedInUser');

  if (userDataCookie) {
    const userData = JSON.parse(userDataCookie);

    document.getElementById('FirstName').textContent = `First Name: ${userData.firstName}`;
    document.getElementById('LastName').textContent = `Last Name: ${userData.lastName}`;
    document.getElementById('Email').textContent = `Email: ${userData.email}`;
    document.getElementById('Img').src = userData.image;

  } else {       
    window.location.href = "login.html"; 
  }
});
   
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  if (logoutBtn) {
    logoutBtn.addEventListener("click", () => {
      deleteCookie("loggedInUser"); 
      alert("You have been logged out!");
      window.location.href = "login.html"; 
    });
  }
});
    
document.addEventListener("DOMContentLoaded", () => {
  

  //todo integrate it with local storage

  fetch('https://dummyjson.com/auth/me', {
    method: 'GET', /* or POST/PUT/PATCH/DELETE */
    headers: {
      'Authorization': 'Bearer ' + JSON.parse(localStorage.getItem('loggedInUser')).token,
      'Content-Type': 'application/json'
    }, 
  })
  .then(res => res.json())
  .then(()=>{
    //todo Show data in the profile page
  });
  

  const loginLink = document.getElementById("loginLink");
  const loggedInUser = getCookie("loggedInUser");

  if (loggedInUser) {
    loginLink.innerHTML = `<i class="fas fa-user me-1"></i> Profile`;
    loginLink.href = "profile.html";
  }
});
</script>
</script>
  <script src="js/navigation.js"></script>
    <script src="js/main.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/api.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>